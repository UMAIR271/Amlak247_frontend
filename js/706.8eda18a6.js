"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[706],{1706:function(e,s,t){t.r(s),t.d(s,{default:function(){return p}});var o=t(9389),n=t(849),a=t(2989);const r=(0,o._)("h1",null,"Agora RTM Vue.js Example",-1);function c(e,s,t,c,i,l){return(0,o.wg)(),(0,o.iD)("div",null,[r,(0,o._)("p",null,"Current user ID: "+(0,n.zw)(i.currentUserID),1),(0,o._)("p",null,"Recipient user ID: "+(0,n.zw)(i.recipientUserID),1),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(i.sendMessageList,(e=>((0,o.wg)(),(0,o.iD)("div",{class:"msg_cotainer_send",key:e},(0,n.zw)(e),1)))),128)),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(i.receivedMessageList,(e=>((0,o.wg)(),(0,o.iD)("div",{class:"msg_cotainer_send",key:e},(0,n.zw)(e),1)))),128)),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(i.chatInbox,(e=>((0,o.wg)(),(0,o.iD)("div",{class:"msg_cotainer_send",key:e.id},(0,n.zw)(e.chat_profile.sender_id),1)))),128)),(0,o.wy)((0,o._)("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=e=>i.message=e),placeholder:"Enter a message"},null,512),[[a.nr,i.message]]),(0,o._)("button",{onClick:s[1]||(s[1]=(...e)=>l.sendMessage&&l.sendMessage(...e))},"Send message to "+(0,n.zw)(i.recipientUserID),1)])}t(2044);var i=t(3057),l=t.n(i),g=t(3669),d={data(){return{client:null,currentUserID:"<YOUR_USER_ID>",recipientUserID:"4",message:"",token:"",sendMessageList:[],receivedMessageList:[],chatInbox:[]}},mounted(){this.currentUserID=localStorage.getItem("user_id"),this.token=localStorage.getItem("token");const e=l().createInstance("21c61a1aa5d44cc09fda7e95b43561a2");this.recivedMessageToServer(),e.login({token:null,uid:this.currentUserID}).then((()=>{console.log("Logged in to Agora RTM successfully")})).catch((e=>{console.log("Failed to log in to Agora RTM",e)})),e.on("MessageFromPeer",((e,s)=>{console.log(`Received message from ${s}: ${e.text}`),this.receivedMessageList.push(e.text)})),this.client=e},methods:{sendMessage(){const e={text:this.message};this.client.sendMessageToPeer(e,this.recipientUserID).then((()=>{console.log("Message sent successfully"),console.log(e.text),this.sendMessageList.push(e.text),this.sendToServer(e)})).catch((e=>{console.log("Failed to send message",e)}))},sendToServer(e){const s={headers:{Accept:"application/json","Content-Type":"multipart/form-data",Authorization:"Bearer "+this.token}};g.Z.post("https://umair2701.pythonanywhere.com/chat/api/send_messages/",{message:e.text,receiver:this.recipientUserID,message_type:"text"},s).then((()=>{console.log("Message sent to server successfully")})).catch((e=>{console.log("Failed to send message to server",e)}))},async recivedMessageToServer(){const e={headers:{Accept:"application/json","Content-Type":"multipart/form-data",Authorization:"Bearer "+this.token}};try{const s=await g.Z.get("https://umair2701.pythonanywhere.com/chat/api/get_chat_inbox/",e);console.log("get_chat_inbox",s.data),this.chatInbox=s.data,console.log("Message sent to server successfully")}catch(s){console.log("Failed to send message to server",s)}}},beforeUnmount(){this.client.logout().then((()=>{console.log("Logged out of Agora RTM successfully")})).catch((e=>{console.log("Failed to log out of Agora RTM",e)}))}},u=t(1935);const h=(0,u.Z)(d,[["render",c]]);var p=h}}]);
//# sourceMappingURL=706.8eda18a6.js.map