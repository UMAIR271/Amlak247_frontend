"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[399],{5399:function(e,s,t){t.r(s),t.d(s,{default:function(){return p}});var n=t(9389),o=t(849),r=t(2989);const l=(0,n._)("h1",null,"Agora RTM Vue.js Example",-1);function a(e,s,t,a,c,i){return(0,n.wg)(),(0,n.iD)("div",null,[l,(0,n._)("p",null,"Current user ID: "+(0,o.zw)(c.currentUserID),1),(0,n._)("p",null,"Recipient user ID: "+(0,o.zw)(c.recipientUserID),1),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(c.sendMessageList,(e=>((0,n.wg)(),(0,n.iD)("div",{class:"msg_cotainer_send",key:e},(0,o.zw)(e),1)))),128)),(0,n.wy)((0,n._)("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=e=>c.message=e),placeholder:"Enter a message"},null,512),[[r.nr,c.message]]),(0,n._)("button",{onClick:s[1]||(s[1]=(...e)=>i.sendMessage&&i.sendMessage(...e))},"Send message to "+(0,o.zw)(c.recipientUserID),1)])}t(2044);var c=t(3057),i=t.n(c),g=t(3669),u={data(){return{client:null,currentUserID:"<YOUR_USER_ID>",recipientUserID:"14",message:"",token:"",sendMessageList:[]}},mounted(){this.currentUserID=localStorage.getItem("user_id"),this.token=localStorage.getItem("token");const e=i().createInstance("21c61a1aa5d44cc09fda7e95b43561a2");e.login({token:null,uid:this.currentUserID}).then((()=>{console.log("Logged in to Agora RTM successfully")})).catch((e=>{console.log("Failed to log in to Agora RTM",e)})),e.on("MessageFromPeer",((e,s)=>{console.log(`Received message from ${s}: ${e.text}`)})),this.client=e},methods:{sendMessage(){const e={text:this.message};this.client.sendMessageToPeer(e,this.recipientUserID).then((()=>{console.log("Message sent successfully"),console.log(e.text),this.sendMessageList.push(e.text),this.sendToServer(e)})).catch((e=>{console.log("Failed to send message",e)}))},sendToServer(e){const s={headers:{Accept:"application/json","Content-Type":"multipart/form-data",Authorization:"Bearer "+this.token}};g.Z.post("http://18.177.139.152/chat/api/send_messages/",{message:e.text,receiver:this.recipientUserID,message_type:"text"},s).then((()=>{console.log("Message sent to server successfully")})).catch((e=>{console.log("Failed to send message to server",e)}))}},beforeUnmount(){this.client.logout().then((()=>{console.log("Logged out of Agora RTM successfully")})).catch((e=>{console.log("Failed to log out of Agora RTM",e)})),i().destroy()}},d=t(1935);const h=(0,d.Z)(u,[["render",a]]);var p=h}}]);
//# sourceMappingURL=399.8a0c746d.js.map